<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro de Revendedor</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
</head>
<body>
  <div id="app">
    <h2>Cadastrar Revendedor</h2>
    <form @submit.prevent="cadastrar">
      <input v-model="form.nome" placeholder="Nome" required />
      <input v-model="form.cidade" placeholder="Cidade" required />
      <input v-model="form.estado" placeholder="Estado" required />
      <input v-model="form.email" placeholder="Email" required />
      <input v-model="form.senha" placeholder="Senha" type="password" required />
      <input v-model="form.cpf" placeholder="CPF" required />
      <input v-model="form.fk_loja_id" type="number" placeholder="Loja ID" required />  <!-- Corrigido aqui -->
      <button type="submit">Cadastrar</button>
    </form>

    <h2>Revendedores Cadastrados</h2>
    <ul>
      <li v-for="rev in revendedores" :key="rev.id">
        {{ rev.nome }} - {{ rev.email }} - Loja {{ rev.fk_loja_id }}  <!-- Corrigido aqui -->
      </li>
    </ul>
  </div>

  <script>
    new Vue({
      el: '#app',
      data() {
        return {
          form: {
            nome: '',
            cidade: '',
            estado: '',
            email: '',
            senha: '',
            cpf: '',
            fk_loja_id: null  // Corrigido aqui
          },
          revendedores: []
        };
      },
      created() {
        this.carregarRevendedores();
      },
      methods: {
        cadastrar() {
          fetch("http://127.0.0.1:8000/revendedores", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(this.form)
          })
            .then(res => res.json())
            .then(() => {
              this.carregarRevendedores();
              this.form = { nome: '', cidade: '', estado: '', email: '', senha: '', cpf: '', fk_loja_id: null };
            })
            .catch(err => console.error("Erro ao cadastrar:", err));
        },
        carregarRevendedores() {
          fetch("http://127.0.0.1:8000/revendedores")
            .then(res => res.json())
            .then(data => this.revendedores = data)
            .catch(err => console.error("Erro ao carregar revendedores:", err));
        }
      }
    });
  </script>
</body>
</html>
